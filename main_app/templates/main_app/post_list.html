{% extends 'base.html' %} {% block content %}

<h1 class="text-center p-3 display-1 spot-text">Feed</h1>

<div class="m-3 shadow rounded p-3">
	<div class="py-3">
		<form
			action="{% url 'post_create' %}"
			enctype="multipart/form-data"
			method="POST"
		>
			{% csrf_token %}
			<label for="creator">New Post as:</label>
			<select class="form-control" name="creator">
				{% for dog in user.profile.dog_set.all %}
				<option value="{{ dog.id }}">{{ dog.name }}</option>
				{% endfor %}
				<div class="form-group">
					<label for="text">Post Content</label>
					<textarea
						id="post-text"
						class="form-control my-1"
						name="text"
						cols="30"
						rows="5"
					></textarea>
				</div>
				<div class="form-group">
					<input class="" type="file" name="photo-file" />
				</div>
				<button class="btn w-100 text-white spot-bg my-1" type="submit">
					Post
				</button>
			</select>
		</form>
	</div>
</div>

{% for post in post_list %}
<div class="m-3 rounded p-3 shadow">
	<div class="bg-white m-1 d-flex flex-column align-items-center p-3 rounded">
		<div
			class="
				border-bottom
				pb-3
				mb-3
				w-100
				d-flex
				flex-row
				align-items-center
				justify-content-start
			"
		>
			<a href="{% url 'dog_detail' post.creator.id  %}">
				<img
					src="https://styles.redditmedia.com/t5_59clj4/styles/communityIcon_3yigconadhw71.png"
					alt=""
					class="img-thumbnail spot-bg-25 rounded-circle"
					style="width: 80px"
				/>
			</a>
			<a href="{% url 'dog_detail' post.creator.id  %}">
				<div class="m-2 d-flex flex-column">
					<span class="fw-bold">{{ post.creator.name }}</span>
					<a href="{% url 'profile_detail' post.creator.profile.id %}"
						><small>{{ post.creator.profile }} - {{post.created_at}}</small></a
					>
				</div>
			</a>
		</div>
		<p>{{ post.text}}</p>

		<a href="{% url 'post_detail' post.id  %}"
			><img class="mw-100 rounded float-right" src="{{ post.image }}" alt=""
		/></a>
	</div>
	<hr />
	<div>
		<details>
			<summary>View {{post.comment_set.count}} comments</summary>
			{% for comment in post.comment_set.all %}
			<div class="">
				<hr />
				<a href="{% url 'profile_detail' comment.author.id %}"
					><small>{{comment.author.get_full_name}}</small></a
				>
				<p>{{comment.text}}</p>
			</div>
			{%endfor%}
		</details>
	</div>
</div>

{% endfor %} {% endblock %}
